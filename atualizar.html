<!-- Mesma estrutura do HTML anterior... substituímos o script -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, getDocs, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDnE2TRKu7-YQpU-H-Dr4zHuhXjxywEVVs",
    authDomain: "walterscheid-estoque.firebaseapp.com",
    projectId: "walterscheid-estoque",
    storageBucket: "walterscheid-estoque.firebasestorage.app",
    messagingSenderId: "487386736937",
    appId: "1:487386736937:web:4be50b32bb7fe90f552f38",
    measurementId: "G-9PL8JP0SD4"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let pedidos = [];
  let currentPage = 1;
  const itemsPerPage = 10;

  async function buscarPedidos() {
    const querySnapshot = await getDocs(collection(db, "pedidos"));
    pedidos = [];
    querySnapshot.forEach((doc) => {
      pedidos.push({ id: doc.id, ...doc.data() });
    });
    atualizarTabela();
  }

  function atualizarTabela() {
    const tbody = document.querySelector("#pedidoTable tbody");
    tbody.innerHTML = "";

    const start = (currentPage - 1) * itemsPerPage;
    const pagePedidos = pedidos.slice(start, start + itemsPerPage);

    pagePedidos.forEach((pedido, index) => {
      const linha = tbody.insertRow();
      linha.innerHTML = `
        <td>${start + index + 1}</td>
        <td>${pedido.item}</td>
        <td>${pedido.quantidade}</td>
        <td>${pedido.parceiro}</td>
        <td>${pedido.status}</td>
      `;
    });

    document.getElementById("page-info").innerText =
      `Página ${currentPage} de ${Math.ceil(pedidos.length / itemsPerPage)}`;
    document.getElementById("prev-btn").disabled = currentPage === 1;
    document.getElementById("next-btn").disabled = (start + itemsPerPage) >= pedidos.length;
  }

  document.getElementById("atualizarBtn").onclick = async function () {
    const pedidoId = document.getElementById("pedidoId").value.trim();
    const novoStatus = document.getElementById("status").value;

    if (!pedidoId) {
      alert("Informe o ID do pedido corretamente.");
      return;
    }

    const pedidoSelecionado = pedidos.find((p, i) => (i + 1).toString() === pedidoId);

    if (!pedidoSelecionado) {
      alert("ID inválido.");
      return;
    }

    try {
      const docRef = doc(db, "pedidos", pedidoSelecionado.id);
      await updateDoc(docRef, { status: novoStatus });
      alert("Status atualizado com sucesso!");
      buscarPedidos();
    } catch (error) {
      console.error(error);
      alert("Erro ao atualizar pedido.");
    }
  };

  window.previousPage = () => {
    if (currentPage > 1) {
      currentPage--;
      atualizarTabela();
    }
  };

  window.nextPage = () => {
    if (currentPage * itemsPerPage < pedidos.length) {
      currentPage++;
      atualizarTabela();
    }
  };

  window.onload = buscarPedidos;
</script>
